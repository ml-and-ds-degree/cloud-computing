{
	"name": "aws-sam-localstack-uv",
	//----------------------------------------------------------------------
	// Base image (Debian bookworm + CPython 3.12 + build essentials + VS Code)
	//----------------------------------------------------------------------
	"image": "mcr.microsoft.com/devcontainers/python:3.12-bookworm",
	//----------------------------------------------------------------------
	// Dev-Container Features
	//----------------------------------------------------------------------
	"features": {
		"ghcr.io/devcontainers/features/docker-in-docker:2": {},
		/* --- AWS CLI -------------------------------------- */
		"ghcr.io/devcontainers/features/aws-cli:1": {},
		/* --- LocalStack w/ helpers (installs: localstack, awslocal, samlocal,
			 AWS CLI, SAM CLI, CDK, etc.) --------------------------------- */
		"ghcr.io/localstack/devcontainer-feature/localstack-cli:latest": {
			"version": "latest"
		},
		/* --- Python package manager -------------------------------------- */
		"ghcr.io/va-h/devcontainers-features/uv:1": {},
		/* --- Shell / Z-sh experience ------------------------------------- */
		"ghcr.io/devcontainers/features/common-utils:2": {
			"installOhMyZsh": true,
			"configureZshAsDefaultShell": true
		},
		"ghcr.io/devcontainers-extra/features/zsh-plugins": {
			"plugins": "aws uv ssh-agent zsh-autosuggestions zsh-syntax-highlighting zsh-you-should-use",
			"omzPlugins": "https://github.com/zsh-users/zsh-autosuggestions https://github.com/zsh-users/zsh-syntax-highlighting https://github.com/MichaelAquilina/zsh-you-should-use"
		}
	},
	//----------------------------------------------------------------------
	// User & Networking
	//----------------------------------------------------------------------
	"containerUser": "vscode",
	"forwardPorts": [
		3000,
		4566 // 4566 = LocalStack edge endpoint
	],
	"runArgs": [
		"--privileged" // Required for Docker-in-Docker
	],
	//----------------------------------------------------------------------
	// Volumes & mounts (host AWS creds â†’ container)
	//----------------------------------------------------------------------
	"mounts": [
		"source=${localEnv:HOME}/.aws,target=/home/vscode/.aws,type=bind,consistency=cached"
	],
	//----------------------------------------------------------------------
	// Post-create bootstrap: install project deps with uv
	//----------------------------------------------------------------------
	"postCreateCommand": {
		"uv-sync": "uv sync",
		// Tools
		"aws-sam-cli-local": "uv tool install aws-sam-cli-local",
		"aws-cli-local": "uv tool install awscli-local",
		"cfn-lint": "uv tool install cfn-lint",
		"task": "uv tool install go-task-bin",
		// Environment actions
		"set-awslocal-completion": "echo 'compdef awslocal=aws' >> ~/.zshrc",
		"set-task-completion": "echo 'eval \"$(task --completion zsh)\"' >> ~/.zshrc"
	},
	//----------------------------------------------------------------------
	// VS Code customisations
	//----------------------------------------------------------------------
	"customizations": {
		"vscode": {
			"extensions": [
				"charliermarsh.ruff",
				"amazonwebservices.aws-toolkit-vscode",
				"kddejong.vscode-cfn-lint",
				"eamodio.gitlens",
				// Exclude from container
				"-ms-python.autopep8",
				"-dbaeumer.vscode-eslint",
				"-redhat.vscode-yaml"
			],
			"settings": {}
		}
	}
}